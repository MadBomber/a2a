# Quick Start Guide

Get up and running with A2A in minutes. This guide will walk you through the basics of using the A2A Ruby gem.

## Installation

First, install the gem:

```bash
gem install a2a
```

## Your First A2A Program

Create a file called `hello_a2a.rb`:

```ruby
#!/usr/bin/env ruby
require 'a2a'

# 1. Create an Agent Card
agent_card = A2A::Models::AgentCard.new(
  name: "Hello Agent",
  url: "https://example.com/a2a",
  version: "1.0.0",
  description: "A friendly greeting agent",
  capabilities: {
    streaming: false,
    push_notifications: false
  },
  skills: [
    {
      id: "greeting",
      name: "Greeting",
      description: "Generate friendly greetings"
    }
  ]
)

# 2. Create a Message
user_message = A2A::Models::Message.text(
  role: "user",
  text: "Say hello!"
)

# 3. Create a Task
task = A2A::Models::Task.new(
  id: "task-#{Time.now.to_i}",
  status: {
    state: "submitted"
  }
)

# 4. Print results
puts "Agent: #{agent_card.name}"
puts "Message: #{user_message.parts.first.text}"
puts "Task ID: #{task.id}"
puts "Task State: #{task.state}"

# 5. Simulate task progression
task = A2A::Models::Task.new(
  id: task.id,
  status: {
    state: "working"
  }
)

puts "\nTask is now: #{task.state}"

# 6. Complete with an artifact
completed_task = A2A::Models::Task.new(
  id: task.id,
  status: {
    state: "completed"
  },
  artifacts: [
    A2A::Models::Artifact.new(
      name: "Greeting",
      parts: [
        A2A::Models::TextPart.new(
          text: "Hello! How can I help you today?"
        )
      ]
    )
  ]
)

puts "Task completed!"
puts "Response: #{completed_task.artifacts.first.parts.first.text}"
```

Run it:

```bash
ruby hello_a2a.rb
```

## Core Concepts in 5 Minutes

### 1. Agent Cards - Agent Discovery

Agent Cards describe what an agent can do:

```ruby
agent_card = A2A::Models::AgentCard.new(
  name: "My Agent",
  url: "https://myagent.example.com/a2a",
  version: "1.0.0",
  capabilities: {
    streaming: true,          # Supports SSE streaming
    push_notifications: true  # Supports webhooks
  },
  skills: [
    {
      id: "skill-1",
      name: "Data Analysis",
      description: "Analyze structured data"
    }
  ]
)
```

### 2. Messages - Communication

Messages contain communication between user and agent:

```ruby
# Text message
user_msg = A2A::Models::Message.text(
  role: "user",
  text: "Analyze this data"
)

# Agent response with multiple parts
agent_msg = A2A::Models::Message.new(
  role: "agent",
  parts: [
    A2A::Models::TextPart.new(text: "Analysis complete:"),
    A2A::Models::DataPart.new(
      data: {
        mean: 45.5,
        median: 42,
        mode: 40
      }
    )
  ]
)
```

### 3. Tasks - Work Units

Tasks track work from submission to completion:

```ruby
# Create a new task
task = A2A::Models::Task.new(
  id: "unique-task-id",
  session_id: "session-123",  # For multi-turn conversations
  status: {
    state: "submitted"
  }
)

# Check state
task.state.submitted?  # => true
task.state.terminal?   # => false

# Progress through states
states = ["submitted", "working", "completed"]
```

### 4. Artifacts - Results

Artifacts are outputs generated by the agent:

```ruby
artifact = A2A::Models::Artifact.new(
  name: "Analysis Results",
  description: "Statistical analysis of dataset",
  parts: [
    A2A::Models::DataPart.new(
      data: {
        summary: "Dataset contains 1000 records",
        statistics: { mean: 42, std_dev: 12.5 }
      }
    )
  ]
)
```

### 5. Parts - Content Types

Parts are polymorphic content types:

```ruby
# Text Part
text = A2A::Models::TextPart.new(
  text: "Hello, world!"
)

# File Part (by URI)
file = A2A::Models::FilePart.new(
  file: {
    name: "data.csv",
    mime_type: "text/csv",
    uri: "https://example.com/data.csv"
  }
)

# File Part (inline bytes)
file_bytes = A2A::Models::FilePart.new(
  file: {
    name: "report.pdf",
    mime_type: "application/pdf",
    bytes: Base64.strict_encode64(pdf_content)
  }
)

# Data Part (structured JSON)
data = A2A::Models::DataPart.new(
  data: {
    results: [1, 2, 3, 4, 5],
    metadata: { processed_at: Time.now }
  }
)
```

## Common Patterns

### Pattern 1: Serialize to JSON

```ruby
require 'json'

agent_card = A2A::Models::AgentCard.new(
  name: "My Agent",
  url: "https://example.com",
  version: "1.0.0",
  capabilities: { streaming: false },
  skills: [{ id: "test", name: "Test" }]
)

# Convert to hash
hash = agent_card.to_h

# Convert to JSON
json = JSON.pretty_generate(hash)
puts json
```

### Pattern 2: Deserialize from JSON

```ruby
require 'json'

json_string = File.read('agent_card.json')
hash = JSON.parse(json_string)

agent_card = A2A::Models::AgentCard.from_hash(hash)
puts agent_card.name
```

### Pattern 3: Error Handling

```ruby
begin
  # Try invalid state
  state = A2A::Models::TaskState.new("invalid")
rescue ArgumentError => e
  puts "Error: #{e.message}"
end

begin
  # Try to raise protocol error
  raise A2A::TaskNotFoundError
rescue A2A::JSONRPCError => e
  puts "Error code: #{e.code}"
  puts "Message: #{e.message}"
end
```

### Pattern 4: Multi-turn Conversation

```ruby
session_id = "session-#{SecureRandom.uuid}"

# First message
task1 = A2A::Models::Task.new(
  id: "task-1",
  session_id: session_id,
  status: { state: "completed" }
)

# Follow-up message in same session
task2 = A2A::Models::Task.new(
  id: "task-2",
  session_id: session_id,  # Same session!
  status: { state: "submitted" }
)
```

## Next Steps

### Learn More

- [Getting Started Guide](guides/getting-started.md) - Comprehensive tutorial
- [Creating Agent Cards](guides/agent-cards.md) - Agent discovery
- [Working with Tasks](guides/tasks.md) - Task lifecycle
- [Messages and Parts](guides/messages.md) - Communication

### Build Something

- [Build a Client](examples/client.md) - Implement an A2A client
- [Build a Server](examples/server.md) - Implement an A2A server
- [Basic Examples](examples/basic.md) - More code examples

### Reference

- [API Documentation](api/index.md) - Complete API reference
- [Architecture](architecture/index.md) - System design
- [Protocol Specification](https://google.github.io/A2A) - Official A2A spec

## Tips and Tricks

### Use Factory Methods

```ruby
# Instead of creating parts manually
message = A2A::Models::Message.new(
  role: "user",
  parts: [A2A::Models::TextPart.new(text: "Hello")]
)

# Use the factory method
message = A2A::Models::Message.text(
  role: "user",
  text: "Hello"
)
```

### Check Task States

```ruby
task = A2A::Models::Task.new(
  id: "task-123",
  status: { state: "completed" }
)

# Use helper methods
task.state.completed?  # => true
task.state.terminal?   # => true (completed, failed, or canceled)
task.state.working?    # => false
```

### Validate Data

The gem validates data automatically:

```ruby
# This will raise ArgumentError
A2A::Models::TaskState.new("invalid-state")

# This will raise ArgumentError
A2A::Models::FileContent.new(name: "file.txt")  # Missing bytes or uri
```

## Common Questions

**Q: How do I serve an Agent Card at `/.well-known/agent.json`?**

A: Use a web framework like Sinatra:

```ruby
require 'sinatra'
require 'a2a'
require 'json'

get '/.well-known/agent.json' do
  content_type :json

  agent = A2A::Models::AgentCard.new(
    name: "My Agent",
    url: "https://#{request.host}/a2a",
    version: "1.0.0",
    capabilities: { streaming: false },
    skills: [{ id: "test", name: "Test" }]
  )

  JSON.generate(agent.to_h)
end
```

**Q: How do I implement an A2A server?**

A: Subclass `A2A::Server::Base` and implement the handler methods. See the [Server Guide](examples/server.md).

**Q: How do I make HTTP requests as a client?**

A: Subclass `A2A::Client::Base` and implement the HTTP logic. See the [Client Guide](examples/client.md).

---

Ready for more? Continue to the [Getting Started Guide](guides/getting-started.md) for a comprehensive tutorial.
